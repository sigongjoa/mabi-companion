<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>마비노기 - 아이템 관리</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #111827; /* 다크 테마 배경 */
            color: #d1d5db;
        }
        .sidebar-link.active {
            background-color: #4f46e5;
            color: #ffffff;
            font-weight: 700;
        }
        .item-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 1.5rem;
        }
        .category-tab {
            transition: all 0.2s ease-in-out;
        }
        .category-tab.active {
            background-color: #6366f1;
            color: #ffffff;
            font-weight: 600;
        }
        .craftable-item {
            border-color: #4ade80;
            box-shadow: 0 0 15px rgba(74, 222, 128, 0.4), 0 0 5px rgba(74, 222, 128, 0.3);
        }
        .item-card {
            cursor: pointer;
        }
    </style>
</head>
<body class="text-gray-800">

    <div class="relative min-h-screen flex">
        <!-- 사이드바 네비게이션 -->
        <aside id="sidebar" class="w-64 bg-gray-900 text-white shadow-lg h-screen fixed top-0 left-0 transform transition-transform duration-300 ease-in-out z-30">
            <div class="p-5 border-b border-gray-700 flex items-center space-x-3">
                 <div class="w-10 h-10 rounded-lg bg-indigo-600 flex items-center justify-center">
                    <svg class="w-6 h-6 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18a8.967 8.967 0 00-6 2.292m0-14.25v14.25" /></svg>
                 </div>
                 <div>
                    <h2 class="text-lg font-bold">마비노기</h2>
                    <p class="text-xs text-gray-400">제작 계산기</p>
                 </div>
            </div>
            <nav class="mt-4">
                <ul>
                    <li><a href="#" class="sidebar-link active flex items-center py-3 px-5">
                        <svg class="w-6 h-6 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21 7.5l-9-5.25L3 7.5m18 0l-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9" /></svg>
                        아이템
                    </a></li>
                    <li><a href="#" class="sidebar-link flex items-center py-3 px-5 text-gray-300 hover:bg-gray-800 transition-colors">
                        <svg class="w-6 h-6 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12h.01M15 12h.01M10.5 16.5h3m-6.38-3.386l-1.591-1.592a2.25 2.25 0 010-3.182l1.591-1.592L9 6.5l1.518-1.518a2.25 2.25 0 013.182 0l1.592 1.591L15 9.5l-1.518 1.518a2.25 2.25 0 01-3.182 0L9 12.5l-1.88-1.88z" /></svg>
                        퀘스트
                    </a></li>
                    <li><a href="mabinogi-lifeskill-management.html" class="sidebar-link flex items-center py-3 px-5 text-gray-300 hover:bg-gray-800 transition-colors">
                        <svg class="w-6 h-6 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.31h5.418a.562.562 0 01.321.988l-4.204 3.055a.563.563 0 00-.182.557l1.528 4.97a.562.562 0 01-.82.622l-4.42-3.232a.563.563 0 00-.664 0l-4.42 3.232a.562.562 0 01-.82-.622l1.528-4.97a.563.563 0 00-.182-.557l-4.204-3.055a.562.562 0 01.321-.988h5.418a.563.563 0 00.475-.31L11.48 3.5z" /></svg>
                        생활스킬
                    </a></li>
                    <li><a href="/character-management.html" class="sidebar-link flex items-center py-3 px-5 text-gray-300 hover:bg-gray-800 transition-colors">
                        <svg class="w-6 h-6 mr-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd" /></svg>
                        캐릭터 관리
                    </a></li>
                </ul>
            </nav>
        </aside>

        <!-- 메인 콘텐츠 -->
        <main id="main-content" class="flex-1 transition-all duration-300 ease-in-out">
            <header class="bg-gray-900 shadow-sm p-4 flex items-center sticky top-0 z-20">
                <button id="sidebar-toggle-btn" class="p-2 mr-4 text-gray-400 hover:text-white">
                    <svg class="w-6 h-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" /></svg>
                </button>
                <div class="text-sm text-gray-400"><span>홈</span><span class="mx-1">/</span><span>아이템</span></div>
            </header>
            
            <div id="root-container" class="p-4 md:p-8">
                <!-- 재화 타이머 섹션 -->
                <section class="mb-12">
                     <h2 class="text-2xl font-bold text-white mb-4">재화 충전 타이머</h2>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                         <!-- 은동전 타이머 -->
                         <div class="bg-gray-800 p-6 rounded-lg">
                            <h3 class="text-lg font-semibold text-white mb-3">은동전 (최대 100개)</h3>
                             <div class="space-y-4">
                                <div>
                                    <label for="silver-coin-input" class="block text-sm font-medium text-gray-400 mb-1">현재 개수 입력</label>
                                    <input type="number" id="silver-coin-input" class="w-full bg-gray-700 border border-gray-600 rounded-md p-2 text-white focus:ring-indigo-500 focus:border-indigo-500" placeholder="예: 75">
                                </div>
                                <div class="w-full bg-gray-700 rounded-full h-4">
                                    <div id="silver-coin-progress" class="bg-indigo-500 h-4 rounded-full transition-all duration-300" style="width: 0%;"></div>
                                </div>
                                <div class="text-center">
                                    <span id="silver-coin-display" class="font-bold text-lg text-white">0 / 100</span>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-400">최대치까지 남은 시간 (1개당 30분)</p>
                                    <p id="silver-coin-timer" class="text-2xl font-bold text-green-400 mt-1">00:00:00</p>
                                </div>
                                <button id="start-silver-coin-timer" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 rounded-lg">타이머 시작</button>
                             </div>
                         </div>
                         <!-- 마족공물 타이머 -->
                         <div class="bg-gray-800 p-6 rounded-lg">
                            <h3 class="text-lg font-semibold text-white mb-3">마족공물 (최대 10개)</h3>
                             <div class="space-y-4">
                                <div>
                                    <label for="demon-tribute-input" class="block text-sm font-medium text-gray-400 mb-1">현재 개수 입력</label>
                                    <input type="number" id="demon-tribute-input" class="w-full bg-gray-700 border border-gray-600 rounded-md p-2 text-white focus:ring-indigo-500 focus:border-indigo-500" placeholder="예: 3">
                                </div>
                                <div class="w-full bg-gray-700 rounded-full h-4">
                                    <div id="demon-tribute-progress" class="bg-red-500 h-4 rounded-full transition-all duration-300" style="width: 0%;"></div>
                                </div>
                                <div class="text-center">
                                    <span id="demon-tribute-display" class="font-bold text-lg text-white">0 / 10</span>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-400">최대치까지 남은 시간 (1개당 12시간)</p>
                                    <p id="demon-tribute-timer" class="text-2xl font-bold text-green-400 mt-1">00:00:00</p>
                                </div>
                                <button id="start-demon-tribute-timer" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 rounded-lg">타이머 시작</button>
                             </div>
                         </div>
                     </div>
                </section>

                <section class="mb-12">
                     <h2 class="text-2xl font-bold text-white mb-4">제작 가능한 아이템</h2>
                     <div id="craftable-items-grid" class="item-grid"></div>
                </section>
                <section>
                    <h2 class="text-2xl font-bold text-white mb-4">내 아이템 목록</h2>
                    <div id="category-tabs" class="flex flex-wrap items-center gap-2 mb-6"></div>
                    <div id="inventory-grid" class="item-grid"></div>
                </section>
            </div>
        </main>
    </div>

    <div id="sidebar-overlay" class="fixed inset-0 bg-black bg-opacity-60 z-20 hidden"></div>
    
    <!-- 아이템 상세 정보 모달 -->
    <div id="item-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-70 hidden">
        <div id="item-modal-content" class="bg-gray-800 rounded-xl shadow-2xl w-full max-w-sm transform transition-all duration-300 scale-95 opacity-0 text-white border border-gray-600">
            <div class="p-6 relative">
                 <button id="modal-close-btn" class="absolute top-3 right-4 text-gray-400 hover:text-white text-3xl font-bold">&times;</button>
                 <div class="flex items-start space-x-4">
                     <div class="relative flex-shrink-0">
                        <img id="modal-item-icon" src="" class="w-20 h-20 rounded-md border-2 border-gray-600">
                        <span id="modal-item-quantity" class="absolute -top-2 -right-2 bg-gray-900 text-white text-sm font-bold px-2.5 py-1 rounded-full border-2 border-gray-500"></span>
                     </div>
                     <div>
                        <h3 id="modal-item-name" class="text-2xl font-bold"></h3>
                        <p id="modal-item-category" class="text-gray-400 font-semibold"></p>
                        <div id="modal-item-tags" class="flex items-center space-x-2 mt-2"></div>
                     </div>
                 </div>
                 <p id="modal-item-description" class="mt-4 text-gray-300 text-sm"></p>
                 <div id="modal-recipe-section" class="mt-4 pt-4 border-t border-gray-700 hidden">
                     <h4 class="text-lg font-semibold mb-3">필요한 재료</h4>
                     <div id="modal-materials-grid" class="flex items-start space-x-4"></div>
                 </div>
                 <div class="mt-4 pt-4 border-t border-gray-700 flex justify-between items-center">
                     <p class="text-sm text-gray-500">무게: <span id="modal-item-weight"></span></p>
                     <div class="flex items-center space-x-2">
                        <p class="text-sm text-yellow-400">구하는 방법</p>
                        <img src="https://placehold.co/20x20/facc15/4d2b07?text=$" alt="Gold coin" class="rounded-full">
                        <span id="modal-item-price" class="font-bold text-lg"></span>
                     </div>
                 </div>
            </div>
            <div class="bg-gray-700 px-6 py-4 flex justify-end space-x-4 rounded-b-xl">
                 <button class="px-5 py-2 bg-gray-600 hover:bg-gray-500 rounded-lg font-semibold transition-colors flex items-center space-x-2"><svg class="w-5 h-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 1a4.5 4.5 0 00-4.5 4.5V9H5a2 2 0 00-2 2v6a2 2 0 002 2h10a2 2 0 002-2v-6a2 2 0 00-2-2h-.5V5.5A4.5 4.5 0 0010 1zm3 8V5.5a3 3 0 10-6 0V9h6z" clip-rule="evenodd" /></svg><span>잠금</span></button>
                 <button class="px-5 py-2 bg-indigo-600 hover:bg-indigo-700 rounded-lg font-bold transition-colors">판매</button>
            </div>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- 데이터 정의 ---
            const categories = ["전체", "보석", "룬", "소모품", "음식", "재료", "재화"];
            const allItemsData = { 1: { name: '붕대', category: '소모품', icon: 'https://placehold.co/80x80/374151/d1d5db?text=붕대', description: '가벼운 상처를 치료하는 데 사용되는 기본적인 붕대.', weight: 0.1, price: 5, tradeable: true, sellable: true }, 2: { name: '고기', category: '음식', icon: 'https://placehold.co/80x80/dc2626/ffffff?text=고기', description: '요리의 기본 재료. 구워먹으면 허기를 채워준다.', weight: 0.5, price: 10, tradeable: true, sellable: true }, 3: { name: '마나 포션', category: '소모품', icon: 'https://placehold.co/80x80/6366f1/ffffff?text=MP', description: '마나를 즉시 회복시켜주는 신비한 물약.', weight: 0.2, price: 50, tradeable: true, sellable: true }, 4: { name: '거미줄', category: '재료', icon: 'https://placehold.co/80x80/374151/d1d5db?text=거미줄', description: '옷감이나 붕대를 만드는 데 사용되는 질긴 거미줄.', weight: 0.1, price: 2, tradeable: true, sellable: true }, 5: { name: '생가죽', category: '재료', icon: 'https://placehold.co/80x80/a16207/ffffff?text=가죽', description: '무두질하여 가죽으로 만들 수 있는 동물의 생가죽.', weight: 1.0, price: 8, tradeable: true, sellable: true }, 7: { name: '세공된 페리도트', category: '보석', icon: 'https://placehold.co/80x80/34d399/115e59?text=페리도트', description: '장신구 제작을 위한 용도로 세공된 페리도트, 페리도트 링, 페리도트 네크리스를 분해하여 얻을 수 있다.', weight: 0.3, price: 1, tradeable: false, sellable: true }, 8: { name: '룬의 파편', category: '룬', icon: 'https://placehold.co/80x80/4ade80/14532d?text=룬파편', description: '고대 룬 문자의 힘이 깃든 파편. 룬 조합에 사용된다.', weight: 0.1, price: 25, tradeable: true, sellable: false }, 9: { name: '밀가루', category: '음식', icon: 'https://placehold.co/80x80/fef3c7/ca8a04?text=밀', description: '빵이나 다양한 요리를 만드는 데 사용되는 고운 밀가루.', weight: 0.3, price: 3, tradeable: true, sellable: true }, 10: { name: '질긴 붕대', category: '소모품', icon: 'https://placehold.co/80x80/475569/e2e8f0?text=질긴붕대', description: '일반 붕대보다 더 효과가 좋은 붕대. 응급처치에 유용하다.', weight: 0.2, price: 15, tradeable: true, sellable: true }, 11: { name: '최고급 가죽', category: '재료', icon: 'https://placehold.co/80x80/ca8a04/fefce8?text=최고급', description: '장인이 무두질한 최고급 가죽. 방어구 제작에 쓰인다.', weight: 0.8, price: 150, tradeable: true, sellable: true }, 12: { name: '스테이크', category: '음식', icon: 'https://placehold.co/80x80/ef4444/fef2f2?text=스테이크', description: '먹음직스럽게 잘 구워진 스테이크. 포만감을 크게 채워준다.', weight: 0.4, price: 45, tradeable: true, sellable: true }, 13: { name: '마나 엘릭서', category: '소모품', icon: 'https://placehold.co/80x80/818cf8/1e1b4b?text=엘릭서', description: '마나 포션보다 훨씬 많은 양의 마나를 회복시킨다.', weight: 0.2, price: 200, tradeable: false, sellable: true }};
            const inventoryMap = new Map([ [1, 10], [2, 59], [3, 30], [4, 21], [5, 45], [7, 3], [8, 310], [9, 15] ]);
            const craftingRecipes = [ { resultId: 10, materials: [{ itemId: 1, quantity: 5 }, { itemId: 4, quantity: 10 }] }, { resultId: 11, materials: [{ itemId: 5, quantity: 50 }] }, { resultId: 12, materials: [{ itemId: 2, quantity: 10 }] }, { resultId: 13, materials: [{ itemId: 3, quantity: 5 }, { itemId: 8, quantity: 20 }] }];

            // --- DOM 요소 ---
            const rootContainer = document.getElementById('root-container');
            const inventoryGrid = document.getElementById('inventory-grid');
            const craftableItemsGrid = document.getElementById('craftable-items-grid');
            const categoryTabsContainer = document.getElementById('category-tabs');
            const itemModal = document.getElementById('item-modal');
            const modalCloseBtn = document.getElementById('modal-close-btn');

            // --- 렌더링 함수 ---
            function renderItem(itemData, container, type) {
                const itemEl = document.createElement('div');
                itemEl.dataset.id = itemData.id;
                itemEl.dataset.type = type;
                itemEl.className = 'item-card flex flex-col items-center bg-gray-800 p-3 rounded-lg justify-between h-full';

                if (type === 'inventory') {
                    itemEl.innerHTML = `<div><img src="${itemData.icon}" alt="${itemData.name}" class="w-20 h-20 rounded-md mx-auto" onerror="this.onerror=null;this.src='https://placehold.co/80x80/333/fff?text=Error';"><p class="mt-2 text-sm text-center font-semibold">${itemData.name}</p></div><div class="flex items-center justify-center mt-3 w-full"><button data-id="${itemData.id}" class="quantity-change-btn minus-btn bg-gray-700 hover:bg-red-600 rounded-l-md px-2 py-1 text-white font-bold">-</button><span class="quantity-display bg-gray-600 px-3 py-1 text-white text-center w-12">${inventoryMap.get(itemData.id)}</span><button data-id="${itemData.id}" class="quantity-change-btn plus-btn bg-gray-700 hover:bg-green-600 rounded-r-md px-2 py-1 text-white font-bold">+</button></div>`;
                } else {
                    itemEl.classList.add('relative', 'border-2', 'border-transparent', 'craftable-item');
                    itemEl.innerHTML = `<div><img src="${itemData.icon}" alt="${itemData.name}" class="w-20 h-20 rounded-md mx-auto"><p class="mt-2 text-sm text-center text-white font-semibold">${itemData.name}</p></div><button data-id="${itemData.id}" class="craft-btn w-full mt-2 bg-green-600 hover:bg-green-700 text-white text-sm font-bold py-1 px-2 rounded-md">제작</button>`;
                }
                container.appendChild(itemEl);
            }

            function renderAllGrids() {
                const activeTab = document.querySelector('.category-tab.active');
                renderInventory(activeTab ? activeTab.textContent : '전체');
                renderCraftableItems();
            }

            function renderCraftableItems() {
                craftableItemsGrid.innerHTML = '';
                const craftableRecipes = craftingRecipes.filter(recipe => canCraft(recipe));
                if (craftableRecipes.length === 0) {
                    craftableItemsGrid.innerHTML = `<p class="col-span-full text-gray-400">제작 가능한 아이템이 없습니다.</p>`;
                    return;
                }
                craftableRecipes.forEach(recipe => renderItem(allItemsData[recipe.resultId], craftableItemsGrid, 'craftable'));
            }

            function renderInventory(filter = '전체') {
                inventoryGrid.innerHTML = '';
                const itemsToRender = Array.from(inventoryMap.keys()).map(id => allItemsData[id]).filter(item => item && (filter === '전체' || item.category === filter));
                if (itemsToRender.length === 0) {
                    inventoryGrid.innerHTML = `<p class="col-span-full text-gray-400">해당 카테고리의 아이템이 없습니다.</p>`;
                    return;
                }
                itemsToRender.forEach(item => renderItem(item, inventoryGrid, 'inventory'));
            }

            // --- 모달 & 타이머 로직 ---
            function openItemModal(itemData, type) { /* ... 기존과 동일 ... */ }
            function closeItemModal() { /* ... 기존과 동일 ... */ }
            function handleCraftItem(itemId) { /* ... 기존과 동일 ... */ }
            function canCraft(recipe) { return recipe.materials.every(mat => (inventoryMap.get(mat.itemId) || 0) >= mat.quantity); }
            
            // --- 이벤트 리스너 ---
            function setupEventListeners() {
                rootContainer.addEventListener('click', (e) => {
                    const quantityBtn = e.target.closest('.quantity-change-btn');
                    const craftBtn = e.target.closest('.craft-btn');
                    const itemCard = e.target.closest('.item-card');

                    if (quantityBtn) {
                        const itemId = parseInt(quantityBtn.dataset.id);
                        const isPlus = quantityBtn.classList.contains('plus-btn');
                        const newQuantity = (inventoryMap.get(itemId) || 0) + (isPlus ? 1 : -1);
                        if (newQuantity >= 0) {
                            inventoryMap.set(itemId, newQuantity);
                            quantityBtn.parentElement.querySelector('.quantity-display').textContent = newQuantity;
                            renderCraftableItems();
                        }
                    } else if (craftBtn) {
                        handleCraftItem(parseInt(craftBtn.dataset.id));
                    } else if (itemCard) {
                        const itemData = allItemsData[parseInt(itemCard.dataset.id)];
                        if (itemData) openItemModal(itemData, itemCard.dataset.type);
                    }
                });
                modalCloseBtn.addEventListener('click', closeItemModal);
                itemModal.addEventListener('click', (e) => { if(e.target === itemModal) closeItemModal(); });
            }

            // --- 재화 타이머 로직 ---
            const timerIntervals = { silver: null, demon: null };
            function formatTime(totalSeconds) {
                if (totalSeconds <= 0) return "00:00:00";
                const d = Math.floor(totalSeconds / 86400);
                const h = Math.floor(totalSeconds % 86400 / 3600).toString().padStart(2, '0');
                const m = Math.floor(totalSeconds % 3600 / 60).toString().padStart(2, '0');
                const s = Math.floor(totalSeconds % 60).toString().padStart(2, '0');
                return d > 0 ? `${d}일 ${h}:${m}:${s}` : `${h}:${m}:${s}`;
            }

            function startTimer(type, inputEl, displayEl, progressEl, timerEl, max, rechargeSec) {
                clearInterval(timerIntervals[type]);
                const current = parseInt(inputEl.value) || 0;
                if (current >= max || current < 0) {
                    timerEl.textContent = current >= max ? "최대치 도달" : "유효하지 않은 값";
                    return;
                }
                let totalSeconds = (max - current) * rechargeSec;
                timerEl.textContent = formatTime(totalSeconds);
                timerIntervals[type] = setInterval(() => {
                    totalSeconds--;
                    timerEl.textContent = formatTime(totalSeconds);
                    if (totalSeconds < 0) {
                        clearInterval(timerIntervals[type]);
                        timerEl.textContent = "충전 완료!";
                    }
                }, 1000);
            }
            
            function setupTimers() {
                const timers = {
                    silver: { max: 100, recharge: 30 * 60 },
                    demon: { max: 10, recharge: 12 * 60 * 60 }
                };
                for (const type in timers) {
                    const input = document.getElementById(`${type}-coin-input`) || document.getElementById(`${type}-tribute-input`);
                    const display = document.getElementById(`${type}-coin-display`) || document.getElementById(`${type}-tribute-display`);
                    const progress = document.getElementById(`${type}-coin-progress`) || document.getElementById(`${type}-tribute-progress`);
                    const timer = document.getElementById(`${type}-coin-timer`) || document.getElementById(`${type}-tribute-timer`);
                    const startBtn = document.getElementById(`start-${type}-coin-timer`) || document.getElementById(`start-${type}-tribute-timer`);
                    
                    input.addEventListener('input', () => {
                        const val = Math.max(0, Math.min(timers[type].max, parseInt(input.value) || 0));
                        display.textContent = `${val} / ${timers[type].max}`;
                        progress.style.width = `${val / timers[type].max * 100}%`;
                    });
                    startBtn.addEventListener('click', () => startTimer(type, input, display, progress, timer, timers[type].max, timers[type].recharge));
                }
            }

            // --- 초기화 ---
            function init() {
                const sidebar = document.getElementById('sidebar'), mainContent = document.getElementById('main-content'), sidebarToggleBtn = document.getElementById('sidebar-toggle-btn'), sidebarOverlay = document.getElementById('sidebar-overlay');
                function applySidebarState(isOpen) { const isDesktop = window.innerWidth >= 768; if (isOpen) { sidebar.classList.remove('-translate-x-full'); sidebarOverlay.classList.remove('hidden'); if (isDesktop) { mainContent.classList.add('md:ml-64'); sidebarOverlay.classList.add('hidden'); } } else { sidebar.classList.add('-translate-x-full'); sidebarOverlay.classList.add('hidden'); if (isDesktop) { mainContent.classList.remove('md:ml-64'); } } }
                function toggleSidebar() { applySidebarState(!sidebar.classList.contains('-translate-x-full')); }
                function initializeSidebar() { applySidebarState(window.innerWidth >= 768); }
                sidebarToggleBtn.addEventListener('click', toggleSidebar);
                sidebarOverlay.addEventListener('click', toggleSidebar);
                window.addEventListener('resize', initializeSidebar);
                
                initializeSidebar();
                setupCategoryTabs();
                renderAllGrids();
                setupEventListeners();
                setupTimers();
            }
            
            init();
        });
    </script>
</body>
</html>
